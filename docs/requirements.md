# スマートフォン向けシューティングゲーム 要件定義書

| 項目 | 内容 |
|------|------|
| ドキュメントバージョン | 1.0 |
| 作成日 | 2026-02-18 |
| ステータス | ドラフト |

---

## 1. プロジェクト概要

### 1.1 プロダクトビジョン

スマートフォンで手軽に遊べる、ハイクオリティなビジュアルと爽快なゲームプレイを両立した縦スクロール型シューティングゲーム。
短時間のセッションでも満足感を得られるゲーム設計と、やり込み要素による長期的なリテンションの両立を目指す。

### 1.2 ターゲットプラットフォーム

| 項目 | 要件 |
|------|------|
| iOS | iOS 16.0 以上 |
| Android | Android 10 (API Level 29) 以上 |
| 画面 | 縦持ち（ポートレートモード）前提 |
| 最低動作端末 | iPhone 12 / Snapdragon 730G 相当以上 |

### 1.3 ターゲットユーザー

- **コア層**: 20〜35歳、シューティングゲームやアクションゲームに馴染みのあるゲーマー
- **カジュアル層**: 通勤・休憩時間に短時間で遊びたいユーザー
- **やり込み層**: スコアアタックやコレクション要素を求めるヘビーユーザー

---

## 2. ゲームデザイン要件

### 2.1 ゲームジャンル・コアループ

- **ジャンル**: 縦スクロール弾幕シューティング
- **視点**: トップダウン 2D（レイヤー構造による擬似的な奥行き表現あり）
- **コアループ**:

```
ステージ選択 → 出撃 → 敵撃破・弾避け → ボス戦 → リザルト → 報酬獲得 → 機体強化 → 次のステージへ
```

### 2.2 操作体系

| 操作 | 方法 |
|------|------|
| 自機移動 | 画面任意の場所をタッチ＆ドラッグ（相対移動方式） |
| 通常射撃 | 自動（オートショット） |
| ボム / 特殊攻撃 | 専用ボタンタップ or 2本指タップ |
| 低速移動（集中モード） | 長押し or 専用ボタン |
| スキル発動 | スキルゲージ満タン時にスキルボタンタップ |

- タッチ操作のレスポンスは **16ms以内**（1フレーム以内）を目標とする
- 指の下に自機が隠れない工夫（自機位置オフセット調整機能）

### 2.3 ステージ構成

| 要素 | 詳細 |
|------|------|
| メインストーリー | 8ワールド × 各5ステージ = 合計40ステージ（初期リリース時） |
| ステージ構成 | 道中（60〜90秒）→ 中ボス → 道中後半 → ボス戦 |
| 難易度 | Easy / Normal / Hard / Inferno の4段階 |
| デイリーチャレンジ | 日替わりの特殊ルールステージ（毎日更新） |
| イベントステージ | 期間限定の高難度・特殊報酬ステージ |

### 2.4 自機（プレイヤーキャラクター）

| 要素 | 詳細 |
|------|------|
| 機体数 | 初期リリース時 12機体以上 |
| レアリティ | N / R / SR / SSR の4段階 |
| パラメータ | 攻撃力 / 連射速度 / 移動速度 / 当たり判定サイズ / スキルゲージ回収率 |
| 固有スキル | 各機体に1つの固有アクティブスキル |
| パッシブ能力 | 各機体に1〜3個のパッシブスキル |
| 強化システム | レベルアップ（素材消費）/ 限界突破 / スキルレベル強化 |
| カスタマイズ | 武装スロット（メイン武器・サブ武器・シールド）の装備変更 |

### 2.5 敵・ボスデザイン

- **ザコ敵**: ワールドごとにテーマに沿った敵デザイン（機械、生物、異次元体など）
- **中ボス**: 各ステージに1体、固有の攻撃パターン（2〜3フェーズ）
- **ボス**: 各ステージに1体、複雑な弾幕パターン（3〜5フェーズ）、演出付き
- **弾幕パターン**: データドリブンで定義。弾の種類は最低20種類（直進弾、追尾弾、放射弾、レーザー、設置弾など）

### 2.6 スコア・報酬システム

| 要素 | 詳細 |
|------|------|
| スコア計算 | 撃破点 × コンボ倍率 + グレイズボーナス + ノーミスボーナス + タイムボーナス |
| コンボ | 連続して敵を撃破するとコンボ倍率上昇（途切れるとリセット） |
| グレイズ | 弾にかすることでボーナス加算（リスク＆リワード要素） |
| ランク | S / A / B / C / D の5段階クリアランク |
| ドロップ報酬 | ゴールド、強化素材、機体の欠片（ガチャ以外の入手経路） |

---

## 3. 技術要件

### 3.1 ゲームエンジン・フレームワーク

| 項目 | 選定 |
|------|------|
| ゲームエンジン | Unity 6 LTS |
| レンダリング | Universal Render Pipeline (URP) 2D |
| スクリプト言語 | C# |
| UI フレームワーク | UI Toolkit |
| ビルドパイプライン | Unity Cloud Build / Fastlane |

### 3.2 パフォーマンス目標

| 項目 | 目標値 |
|------|--------|
| フレームレート | 60fps 安定（最低端末でも30fps以上） |
| 同時描画弾数 | 2,000発以上（パフォーマンス劣化なし） |
| 同時描画敵数 | 50体以上 |
| ロード時間 | ステージ開始まで3秒以内（初回除く） |
| アプリサイズ | 初回DL 200MB以下、全データDL後 1GB以下 |
| メモリ使用量 | 実行時 800MB以下 |
| バッテリー消費 | 連続プレイ1時間でバッテリー消費15%以下（3,000mAh基準） |

### 3.3 アーキテクチャ概要

```
┌─────────────────────────────────────────────────────┐
│                    クライアント (Unity)                │
├──────────┬──────────┬──────────┬────────────────────┤
│ ゲーム   │ UI       │ サウンド │ ネットワーク       │
│ ロジック │ マネージャ│ マネージャ│ マネージャ         │
│          │          │          │                    │
│ ・弾幕   │ ・HUD    │ ・BGM    │ ・REST API通信     │
│  エンジン│ ・メニュー│ ・SE     │ ・アセットDL       │
│ ・当たり │ ・ガチャ  │ ・ボイス │ ・リアルタイム通信  │
│  判定    │  演出    │          │  (WebSocket)       │
│ ・AI     │          │          │                    │
├──────────┴──────────┴──────────┴────────────────────┤
│              ローカルデータ管理 (SQLite)               │
└─────────────────────────────────────────────────────┘
                          │
                    HTTPS / WSS
                          │
┌─────────────────────────────────────────────────────┐
│                   サーバーサイド                       │
├──────────┬──────────┬──────────┬────────────────────┤
│ API      │ ゲーム   │ マッチ   │ 管理               │
│ ゲート   │ サーバー │ メイキング│ ツール             │
│ ウェイ   │          │          │                    │
├──────────┴──────────┴──────────┴────────────────────┤
│          インフラ (AWS / GCP)                         │
│  ・ECS/GKE  ・RDS/CloudSQL  ・Redis  ・S3/GCS       │
│  ・CloudFront/Cloud CDN  ・SQS/Pub/Sub               │
└─────────────────────────────────────────────────────┘
```

### 3.4 弾幕エンジン設計方針

- **ECS (Entity Component System)** ベースの設計で大量オブジェクトを効率的に処理
- **オブジェクトプール**: 弾・エフェクト・敵は全てプール管理（GC発生を最小化）
- **空間分割**: グリッドベースの空間分割で当たり判定を最適化
- **弾幕定義**: ScriptableObject + JSON によるデータドリブン弾幕パターン定義
- **Job System + Burst Compiler**: 弾の移動・判定をマルチスレッド化

### 3.5 アセット管理

| 項目 | 方針 |
|------|------|
| アセットバンドル | Addressables による非同期ロード |
| テクスチャ | ASTC圧縮（iOS/Android共通） |
| スプライト | Sprite Atlas による描画バッチング |
| アニメーション | Spine 2D（キャラクター）/ パーティクルシステム（エフェクト） |
| サウンド | ADX2 or Wwise によるサウンドミドルウェア |

---

## 4. サーバーサイド要件

### 4.1 バックエンド構成

| 項目 | 技術選定 |
|------|----------|
| API サーバー | Go / gRPC + REST (OpenAPI) |
| データベース | PostgreSQL（マスターデータ）/ Redis（セッション・キャッシュ） |
| リアルタイム通信 | WebSocket (マルチプレイ用) |
| 認証 | Firebase Authentication / Apple Sign-In / Google Sign-In |
| CDN | CloudFront or Cloud CDN（アセット配信） |
| プッシュ通知 | Firebase Cloud Messaging (FCM) / APNs |
| 分析基盤 | BigQuery + Firebase Analytics |

### 4.2 主要 API 一覧

| カテゴリ | エンドポイント例 | 機能 |
|----------|------------------|------|
| 認証 | `POST /auth/login` | ログイン・トークン発行 |
| ユーザー | `GET /users/me` | ユーザー情報取得 |
| 機体 | `POST /units/upgrade` | 機体強化 |
| ステージ | `POST /stages/{id}/start` | ステージ開始 |
| ステージ | `POST /stages/{id}/result` | ステージ結果送信 |
| ガチャ | `POST /gacha/draw` | ガチャ実行 |
| ランキング | `GET /rankings/{type}` | ランキング取得 |
| ショップ | `POST /shop/purchase` | アイテム購入 |
| フレンド | `POST /friends/request` | フレンド申請 |

### 4.3 データ整合性・セキュリティ

- ステージクリア結果はサーバーサイドでバリデーション（リプレイデータ検証）
- 通信は全て TLS 1.3
- APIレートリミット実装
- 不正検知システム（異常スコア検出、改ざんチェック）
- マスターデータはサーバーから配信（クライアント改ざん防止）

---

## 5. マネタイズ要件

### 5.1 基本方針

**基本無料 + アプリ内課金** モデルを採用。課金しなくてもゲームの主要コンテンツは全て遊べる設計とする。

### 5.2 課金アイテム

| アイテム | 価格帯 | 内容 |
|----------|--------|------|
| 有償ジェム | 120円〜12,000円 | ガチャ・スタミナ回復・コンティニューに使用 |
| 月額パス | 480円/月 | 毎日ジェム + 限定報酬 + 広告非表示 |
| シーズンパス | 1,200円/シーズン | シーズン限定報酬の解放 |
| スキンパック | 600〜1,800円 | 機体の見た目変更（能力変化なし） |
| 初心者応援パック | 480円（1回限り） | ジェム + SR機体確定チケット |

### 5.3 ガチャ仕様

| 項目 | 詳細 |
|------|------|
| 排出率 | SSR: 3% / SR: 15% / R: 50% / N: 32% |
| 天井 | 200連でピックアップSSR確定 |
| 10連ボーナス | SR以上1体確定 |
| 無料ジェム | デイリーミッション・ログインボーナス等で月間約30連分 |

### 5.4 広告（任意視聴型のみ）

- ステージクリア後にリワード広告視聴で報酬2倍
- デイリーボーナスの追加報酬
- コンティニュー（1ステージ1回まで）
- 強制広告は一切なし

---

## 6. マルチプレイ・ソーシャル要件

### 6.1 協力プレイ（Co-op）

| 項目 | 詳細 |
|------|------|
| プレイ人数 | 2人協力プレイ |
| 通信方式 | WebSocket によるリアルタイム同期 |
| マッチング | ルームID共有 or 自動マッチング |
| 対象ステージ | 専用Co-opステージ + メインステージのCo-opモード |
| 遅延許容 | 100ms以内の入力遅延を目標 |

### 6.2 ランキング

- **週間スコアランキング**: ステージ別ハイスコア
- **シーズンランキング**: シーズン累計ポイント
- **フレンドランキング**: フレンド間のスコア比較

### 6.3 フレンド機能

- フレンドID検索による申請
- 助っ人機体のレンタル（1日3回まで）
- フレンドへのスタミナギフト送信

---

## 7. UI/UX 要件

### 7.1 画面一覧

| 画面 | 機能 |
|------|------|
| タイトル | ログイン・お知らせ・データDL |
| ホーム | メインメニュー、キャラクター表示、各機能への導線 |
| ステージ選択 | ワールドマップ、ステージ一覧、難易度選択 |
| 編成 | 機体選択、装備変更、スキル確認 |
| ゲームプレイ | メインのシューティング画面 |
| リザルト | スコア表示、ランク、獲得報酬 |
| 機体一覧 | 所持機体の確認・強化・限界突破 |
| ガチャ | ガチャ演出・排出結果 |
| ショップ | 課金アイテム・ジェムパック |
| ランキング | スコアランキング表示 |
| フレンド | フレンド一覧・検索・申請 |
| ミッション | デイリー・ウィークリー・実績 |
| 設定 | サウンド・操作設定・アカウント連携・通知設定 |

### 7.2 ゲームプレイ HUD

```
┌──────────────────────────┐
│ [スコア]     [コンボ]     │
│ [HP ████████░░]          │
│                          │
│                          │
│       （ゲームエリア）     │
│                          │
│                          │
│                          │
│   [スキル]  [ボム ×3]    │
│ [一時停止]               │
└──────────────────────────┘
```

- HUD要素は半透明で操作の邪魔にならない設計
- ノッチ・パンチホールの安全領域を考慮したレイアウト
- HUDの表示/非表示・位置のカスタマイズ機能

### 7.3 アクセシビリティ

- 色覚多様性対応（弾の色だけでなく形状でも区別可能に）
- 文字サイズ変更機能
- 画面振動ON/OFF設定
- 片手操作モード対応

---

## 8. サウンド・ビジュアル要件

### 8.1 グラフィック

| 要素 | 詳細 |
|------|------|
| アートスタイル | SF × アニメ調のハイブリッド |
| 解像度 | 基準 1080×1920、高解像度端末は動的スケーリング |
| エフェクト | パーティクルベース + シェーダーエフェクト（HDR Bloom、歪みなど） |
| 背景 | 多層パララックススクロール（3〜5層） |
| キャラクター | Spine 2D アニメーション（ホーム画面・ガチャ演出） |
| 弾幕 | 発光・トレイル・着弾エフェクト |

### 8.2 サウンド

| 要素 | 詳細 |
|------|------|
| BGM | ワールドごとのテーマ曲（各2〜3分ループ）、ボス戦専用曲 |
| SE | 射撃音、被弾音、爆発音、UI操作音 等 100種類以上 |
| ボイス | 機体ごとの出撃・スキル発動・被弾ボイス（日本語/英語） |
| 動的ミキシング | ゲーム状況に応じたBGMの動的変化（ボス残HP連動など） |

---

## 9. 運用要件

### 9.1 イベントサイクル

| 頻度 | 内容 |
|------|------|
| 毎日 | デイリーミッション更新、デイリーチャレンジステージ |
| 毎週 | ウィークリーミッション更新、ランキングリセット |
| 隔週 | 新ガチャピックアップ |
| 毎月 | シーズン更新、新イベントステージ |
| 四半期 | 大型アップデート（新ワールド・新機体追加） |

### 9.2 KPI 目標

| 指標 | 目標値 |
|------|--------|
| DAU | リリース3ヶ月後 50,000 |
| 7日リテンション | 35%以上 |
| 30日リテンション | 15%以上 |
| 課金率 | 5%以上 |
| ARPU | 月額 500円以上 |
| 平均セッション時間 | 15分以上 |

### 9.3 管理ツール（Admin）

- ユーザー情報の検索・閲覧・BAN
- お知らせ・メンテナンス通知の配信
- マスターデータの編集・配信
- イベントのスケジュール管理
- KPI ダッシュボード
- ガチャ排出率のリアルタイム監視
- 不正検知アラート

---

## 10. 品質保証要件

### 10.1 テスト方針

| テスト種別 | 内容 |
|------------|------|
| 単体テスト | ゲームロジック、弾幕パターン、スコア計算 |
| 結合テスト | API通信、データ永続化、課金フロー |
| UIテスト | 全画面遷移、操作レスポンス、レイアウト崩れ |
| パフォーマンステスト | 大量弾幕時のFPS計測、メモリリーク検出 |
| 端末互換テスト | iOS/Android 主要20機種以上での動作確認 |
| セキュリティテスト | チート対策、通信改ざん検知、脆弱性診断 |
| βテスト | クローズドβ（1,000名規模）→ オープンβ（10,000名規模） |

### 10.2 CI/CD パイプライン

```
コード Push → 静的解析 → 単体テスト → ビルド → 自動UIテスト → ステージング配信 → QA → 本番配信
```

- GitHub Actions / GitLab CI によるパイプライン自動化
- TestFlight (iOS) / Firebase App Distribution (Android) でのテスト配信

---

## 11. リリース計画

### 11.1 マイルストーン

| フェーズ | 内容 |
|----------|------|
| α版 | コアゲームプレイ完成（移動・射撃・弾幕・ボス戦）、3ステージ |
| β版 | 全システム結合（強化・ガチャ・ミッション）、20ステージ、Co-op |
| クローズドβ | 限定ユーザーテスト、バランス調整 |
| オープンβ | 大規模テスト、サーバー負荷検証 |
| 正式リリース | 40ステージ、12機体、全機能実装 |
| リリース後 | 定期アップデート、イベント運用 |

### 11.2 対応言語（初期リリース時）

日本語 / 英語 / 韓国語 / 中国語（繁体・簡体）

---

## 12. リスクと対策

| リスク | 影響度 | 対策 |
|--------|--------|------|
| パフォーマンス不足（低スペック端末） | 高 | 描画品質の動的調整、弾数の自動制限 |
| サーバー障害 | 高 | オフラインプレイモードの確保、自動フェイルオーバー |
| チート・不正行為 | 高 | サーバーサイドバリデーション、リプレイ検証 |
| ガチャ規制強化 | 中 | 天井システム実装済み、確率表示の徹底 |
| 競合タイトルの出現 | 中 | 差別化要素の継続的追加、コミュニティ育成 |
| アセット容量の肥大化 | 中 | アセットバンドルの分割DL、不要データの自動削除 |

---

## 付録A: 用語集

| 用語 | 説明 |
|------|------|
| 弾幕 | 大量の弾が画面を埋め尽くすシューティング特有のパターン |
| グレイズ | 弾にかすること。リスクと引き換えにボーナスを得る |
| ECS | Entity Component System。大量のオブジェクトを効率的に管理するアーキテクチャ |
| 天井 | ガチャの救済措置。一定回数で目当てのアイテムが確定で手に入る |
| リテンション | ユーザーがゲームに戻ってくる割合 |
| ARPU | Average Revenue Per User。ユーザー1人あたりの平均収益 |
